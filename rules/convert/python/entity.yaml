# Entity 클래스 생성 Role
# 타겟: SQLAlchemy Entity

name: "Entity 클래스 생성"
description: "Oracle 테이블을 SQLAlchemy Entity로 변환"
version: "1.0"

# 저장 경로 정의
path: "entity"

# 입력 스키마
input_schema:
  required:
    - table_json_data  # 테이블 메타데이터 (JSON 문자열)
    - project_name     # 프로젝트 이름
    - locale          # 언어 설정 (ko/en)

# 프롬프트 (Jinja2 템플릿)
prompt: |
  당신은 클린 아키텍처 원칙을 따르는 파이썬 애플리케이션을 개발하는 소프트웨어 엔지니어입니다. 주어진 JSON 형식의 테이블 데이터를 기반으로 SQLAlchemy 엔티티 클래스를 생성하는 작업을 맡았습니다.
  
  
  사용자 언어 설정 : {{locale}}, 입니다. 이를 반영하여 결과를 생성해주세요.
  
  
  테이블 데이터(JSON)입니다:
  {{table_json_data}}
  
  
  [SECTION 1] SQLAlchemy 엔티티 클래스 생성 규칙
  ===============================================
  1. 변환 범위
     - 각 테이블(JSON) 객체는 독립적인 엔티티 클래스로 변환
     - 하나의 JSON 객체 -> 하나의 엔티티 클래스
  
  2. 클래스 명명 규칙
     - JSON 객체의 'name' 필드를 파스칼 케이스로 변환
     - 복수형을 단수형으로 변경
     - entityName도 동일한 규칙 적용
     - TPJ_ , DDL_ 같은 접두사를 절대적으로 유지하세요
     예시) B_Plcy_Month -> BPlcyMonth
          Employees -> Employee
          TPJ_PLCY_MONTH -> TpjPlcyMonth
          DDL_PLCY_MONTH -> DdlPlcyMonth
  
  3. 필드 규칙
     - Column 클래스 사용
     - 테이블명은 스네이크 케이스, JSON 객체의 'name' 필드 그대로 사용
     - JSON의 'fields' 배열의 각 항목을 클래스 속성으로 변환
     예시) B_PLCY_MONTH -> b_plcy_month
  
  4. 기본키(Primary Key) 처리 규칙
     - 모든 엔티티는 'id' 필드를 기본키로 사용
     - Column(Integer, primary_key=True, autoincrement=True) 적용
     - 테이블 메타 데이터에 기본키 정보가 있을 경우, unique=True 적용
  
  5. 데이터 타입 매핑
     - NUMBER, NUMERIC, INTEGER, DECIMAL, BIGDECIMAL, FLOAT, DOUBLE, REAL 등 모든 숫자 타입(정수 및 실수 포함) -> 반드시 Integer만 사용
     - VARCHAR2, CHAR: String
     - DATE & TIME: 
          * 컬럼명에 'TIME'이 포함된 경우 -> DateTime
          * 컬럼명에 'DATE'만 포함되고 'TIME'이 없는 경우 -> Date
     - CLOB: String
     - BLOB, RAW: LargeBinary
     - BOOLEAN: Boolean
  
  6. Import 선언
     - sqlalchemy의 필수 패키지 임포트
     - declarative_base() 함수 사용
  
                                              
  [SECTION 2] SQLAlchemy 엔티티 클래스 기본 템플릿
  ===============================================
  from sqlalchemy import Column, Integer, String, Boolean, DateTime, Date, LargeBinary
  from sqlalchemy.ext.declarative import declarative_base
  
  Base = declarative_base()
  
  class EntityName(Base):
      __tablename__ = "table_name"
      
      id = Column(Integer, primary_key=True, autoincrement=True)
      original_primary_key = Column(String, nullable=False, unique=True)
      required_field = Column(String, nullable=False)
      optional_field = Column(String)
      # ...
  
                                              
  [SECTION 3] JSON 출력 형식
  ===============================================
  부가 설명 없이 결과만을 포함하여, 다음 JSON 형식으로 반환하세요:
  {
      "analysis": [
          {
              "entityName": "EntityName",
              "code": "Python Code"
          }
      ]
  }